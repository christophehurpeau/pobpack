{"version":3,"file":"cli-node12.cjs.js","sources":["../src/createBrowserWebpackConfig.ts","../src/index.ts","../src/cli.ts"],"sourcesContent":["/* eslint-disable complexity */\nimport path from 'path';\nimport ReactRefreshWebpackPlugin from '@pmmmwh/react-refresh-webpack-plugin';\nimport type {\n  Options,\n  ConfigEntry,\n  FilledWebpackConfiguration,\n} from 'pobpack-types';\nimport {\n  createModuleConfig,\n  createPluginsConfig,\n  createResolveConfig,\n} from 'pobpack-utils';\nimport webpack from 'webpack';\nimport WorkboxWebpackPlugin from 'workbox-webpack-plugin';\n\nexport type BrowserTargetType = 'modern' | 'all';\n\nexport const MODERN = 'modern';\nexport const ALL = 'all';\nexport const TARGETS: BrowserTargetType[] = [ALL, MODERN];\n\nconst ExcludesFalsy = (Boolean as unknown) as <T>(\n  x: T | boolean | null | undefined,\n) => x is T;\n\nconst webpackDevClientEntry = require.resolve(\n  'react-dev-utils/webpackHotDevClient',\n);\n\nexport default function createBrowserWebpackConfig(target: BrowserTargetType) {\n  return (options: Options): FilledWebpackConfiguration => ({\n    // production or development\n    mode: options.env === 'production' ? 'production' : 'development',\n\n    // Don't attempt to continue if there are any errors.\n    bail: options.env === 'production',\n\n    // Target web\n    target: target === MODERN ? 'web' : ['web', 'es5'],\n\n    // get right stack traces\n    devtool:\n      options.env === 'production' ? 'nosources-source-map' : 'source-map',\n\n    optimization: {\n      emitOnErrors: false,\n      minimize: options.env === 'production',\n      ...options.optimization,\n    },\n\n    // use cache\n    cache: options.hmr,\n\n    resolveLoader: {\n      modules: options.resolveLoaderModules || ['node_modules'],\n    },\n\n    resolve: createResolveConfig(\n      [target === MODERN ? 'modern-browsers' : undefined, 'browser'].filter(\n        ExcludesFalsy,\n      ),\n      {\n        ...options,\n        babel: {\n          presets: [require.resolve('../babel')],\n          ...options.babel,\n          plugins: [\n            ...(options.babel.plugins || []),\n            options.hmr && require.resolve('react-refresh/babel'),\n          ].filter(ExcludesFalsy),\n        },\n      },\n    ),\n\n    entry: options.entries.reduce(\n      (entries: { [key: string]: string[] }, entry: ConfigEntry) => {\n        if (typeof entry === 'string') entry = { key: entry, path: entry };\n        entries[entry.key] = [\n          // options.env !== 'production' && require.resolve('../source-map-support'),\n          target !== MODERN && require.resolve('regenerator-runtime/runtime'),\n          options.hmr && webpackDevClientEntry,\n          path.join(path.resolve(options.paths.src as string), entry.path),\n        ].filter(ExcludesFalsy);\n        return entries;\n      },\n      {},\n    ),\n\n    output: {\n      path: path.resolve(options.paths.build as string),\n      // Point sourcemap entries to original disk location\n\n      // devtoolModuleFilenameTemplate: 'file://[absolute-resource-path]',\n      devtoolModuleFilenameTemplate:\n        options.env === 'production'\n          ? (info: any) =>\n              path\n                .relative(\n                  options.paths.src as string,\n                  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n                  info.absoluteResourcePath,\n                )\n                .replace(/\\\\/g, '/')\n          : // eslint-disable-next-line unicorn/no-nested-ternary\n          options.env === 'development'\n          ? (info: any) =>\n              // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n              path.resolve(info.absoluteResourcePath).replace(/\\\\/g, '/')\n          : undefined,\n    },\n\n    module: createModuleConfig(options),\n\n    plugins: [\n      ...createPluginsConfig(options),\n      new webpack.ProvidePlugin({\n        process: 'process/browser',\n      }),\n      options.hmr &&\n        new ReactRefreshWebpackPlugin({\n          overlay: {\n            // Create React App overlay config\n            entry: webpackDevClientEntry,\n            module: require.resolve('react-dev-utils/refreshOverlayInterop'),\n            sockIntegration: false,\n          },\n        }),\n      options.env === 'production' &&\n      options.paths.src &&\n      options.serviceWorkerEntry\n        ? new WorkboxWebpackPlugin.InjectManifest({\n            swSrc: path.resolve(\n              options.paths.src,\n              options.serviceWorkerEntry.endsWith('.js') ||\n                options.serviceWorkerEntry.endsWith('.ts')\n                ? options.serviceWorkerEntry\n                : `${options.serviceWorkerEntry}${\n                    options.typescript ? '.ts' : '.js'\n                  }`,\n            ),\n            compileSrc: true,\n            dontCacheBustURLsMatching: /\\.[\\da-f]{8}\\./,\n            exclude: [/\\.map$/, /asset-manifest\\.json$/, /LICENSE/],\n          })\n        : undefined,\n    ].filter(ExcludesFalsy),\n  });\n}\n","import path from 'path';\nimport type {\n  Options,\n  PobpackCompiler,\n  WatchCallback,\n  CreateCompilerOptions,\n} from 'pobpack-types';\nimport { createPobpackCompiler, createAppWebpackConfig } from 'pobpack-utils';\nimport errorOverlayMiddleware from 'react-dev-utils/errorOverlayMiddleware';\nimport evalSourceMapMiddleware from 'react-dev-utils/evalSourceMapMiddleware';\nimport ignoredFiles from 'react-dev-utils/ignoredFiles';\nimport noopServiceWorkerMiddleware from 'react-dev-utils/noopServiceWorkerMiddleware';\nimport type { Stats } from 'webpack';\nimport WebpackDevServer from 'webpack-dev-server';\nimport type { Configuration as WebpackDevServerConfiguration } from 'webpack-dev-server';\nimport type { BrowserTargetType } from './createBrowserWebpackConfig';\nimport createBrowserWebpackConfig, {\n  TARGETS,\n  ALL,\n  MODERN,\n} from './createBrowserWebpackConfig';\n\nexport { TARGETS, ALL, MODERN };\n\nexport const createAppBrowserCompiler = (\n  target: BrowserTargetType,\n  options: Partial<Options>,\n  compilerOptions?: CreateCompilerOptions,\n): PobpackCompiler =>\n  createPobpackCompiler(\n    target,\n    createAppWebpackConfig(createBrowserWebpackConfig(target))({\n      entries: [{ key: target, path: 'index' }], // override default entry\n      ...options,\n      paths: { build: 'public', ...options.paths },\n    }),\n    compilerOptions,\n  );\n\nexport const build = (options = {}): Promise<Stats | undefined>[] => {\n  if (!process.env.NODE_ENV) process.env.NODE_ENV = 'production';\n  const compilers = TARGETS.map((t) =>\n    createAppBrowserCompiler(t, { ...options, hmr: false }),\n  );\n  compilers[0].clean();\n  return compilers.map((compiler) => compiler.run());\n};\n\nexport const watch = (\n  options: Partial<Options>,\n  callback?: WatchCallback,\n): PobpackCompiler => {\n  if (typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n  const compiler = createAppBrowserCompiler(MODERN, { ...options, hmr: true });\n  compiler.clean();\n  compiler.watch(callback as WatchCallback);\n  return compiler;\n};\n\ntype Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n\nexport interface RunOptions\n  extends Omit<\n    WebpackDevServerConfiguration,\n    'hot' | 'quiet' | 'overlay' | 'compress' | 'before'\n  > {\n  host?: string;\n  https?: boolean;\n  port: number;\n}\n\nexport const runDevServer = (\n  compiler: PobpackCompiler,\n  options: RunOptions,\n  srcPath = path.resolve('src'),\n): WebpackDevServer => {\n  const { host, port, https, ...webpackDevServerOptions } = options;\n  const browserDevServer = new WebpackDevServer(compiler.compiler, {\n    hot: true,\n    // Use 'ws' instead of 'sockjs-node' on server since we're using native\n    // websockets in react-scripts `webpackHotDevClient`.\n    transportMode: 'ws',\n    // Prevent a WS client from getting injected as we're already including\n    // react-scripts `webpackHotDevClient`.\n    injectClient: false,\n    publicPath: '/',\n\n    // use react-scripts ignoredFiles for perf\n    watchOptions: {\n      ignored: ignoredFiles(srcPath),\n    },\n\n    // stats: 'errors-only',\n    quiet: true, // errors are displayed with friendly-errors plugin\n    overlay: false, // We use create-react-app-overlay\n    compress: true, // Enable gzip compression of generated files\n    // Silence WebpackDevServer's logs. Still displays errors and warnings\n    clientLogLevel: 'none',\n\n    // without page refresh as fallback in case of build failures: hotOnly: true,\n    https,\n    ...webpackDevServerOptions,\n\n    before(app, server): void {\n      // https://github.com/facebook/create-react-app/blob/30ee52cf3b2cbb6ac70999c02b1196bcaba8d4ca/packages/react-scripts/config/webpackDevServer.config.js#L99\n      // This lets us fetch source contents from webpack for the error overlay\n      app.use(evalSourceMapMiddleware(server));\n      // This lets us open files from the runtime error overlay.\n      app.use(errorOverlayMiddleware());\n    },\n\n    after(app): void {\n      // This service worker file is effectively a 'no-op' that will reset any\n      // previous service worker registered for the same host:port combination.\n      // We do this in development to avoid hitting the production cache if\n      // it used the same host and port.\n      // https://github.com/facebook/create-react-app/issues/2272#issuecomment-302832432\n      app.use(noopServiceWorkerMiddleware('/'));\n    },\n  });\n  browserDevServer.listen(port, host as string); // note: host can be undefined, but types does not support it\n  return browserDevServer;\n};\n\nexport type PobpackBrowserCompiler = PobpackCompiler & {\n  webpackDevServer: WebpackDevServer;\n};\n\nexport const watchAndRunDevServer = (\n  options: Partial<Options>,\n  runOptions: RunOptions,\n): PobpackBrowserCompiler => {\n  const url = `http${runOptions.https ? 's' : ''}://localhost:${\n    runOptions.port\n  }`;\n  const compiler: PobpackCompiler = createAppBrowserCompiler(\n    MODERN,\n    { ...options, hmr: true },\n    {\n      successMessage: `Your application is running here: ${url}`,\n    },\n  );\n  compiler.clean();\n  const webpackDevServer = runDevServer(compiler, runOptions);\n  return { ...compiler, webpackDevServer };\n};\n","/* eslint-disable unicorn/no-process-exit */\nimport { build, watchAndRunDevServer } from '.';\n\nconst cmd = process.argv[2];\n\nif (cmd === 'build') {\n  build();\n} else if (cmd === 'start' || !cmd) {\n  watchAndRunDevServer(\n    {},\n    { port: Number(process.env.PORT) || 8080, https: false },\n  );\n} else {\n  console.log(`Invalid command: ${cmd}`);\n  process.exit(1);\n}\n"],"names":["MODERN","TARGETS","ExcludesFalsy","Boolean","webpackDevClientEntry","require","resolve","createBrowserWebpackConfig","target","options","mode","env","bail","devtool","optimization","emitOnErrors","minimize","cache","hmr","resolveLoader","modules","resolveLoaderModules","createResolveConfig","undefined","filter","babel","presets","plugins","entry","entries","reduce","key","path","join","paths","src","output","build","devtoolModuleFilenameTemplate","info","relative","absoluteResourcePath","replace","module","createModuleConfig","createPluginsConfig","webpack","ProvidePlugin","process","ReactRefreshWebpackPlugin","overlay","sockIntegration","serviceWorkerEntry","WorkboxWebpackPlugin","InjectManifest","swSrc","endsWith","typescript","compileSrc","dontCacheBustURLsMatching","exclude","createAppBrowserCompiler","compilerOptions","createPobpackCompiler","createAppWebpackConfig","NODE_ENV","compilers","map","t","clean","compiler","run","runDevServer","srcPath","host","port","https","webpackDevServerOptions","browserDevServer","WebpackDevServer","hot","transportMode","injectClient","publicPath","watchOptions","ignored","ignoredFiles","quiet","compress","clientLogLevel","before","app","server","use","evalSourceMapMiddleware","errorOverlayMiddleware","after","noopServiceWorkerMiddleware","listen","watchAndRunDevServer","runOptions","url","successMessage","webpackDevServer","cmd","argv","Number","PORT","console","log","exit"],"mappings":"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"}