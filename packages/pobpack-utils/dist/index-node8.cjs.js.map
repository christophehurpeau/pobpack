{"version":3,"file":"index-node8.cjs.js","sources":["../src/createOptions.ts","../src/createAppWebpackConfig.ts","../src/FriendlyErrorsWebpackPlugin.ts","../src/createPobpackCompiler.ts","../src/webpack/createModuleConfig.ts","../src/webpack/createPluginsConfig.ts","../src/webpack/createResolveConfig.ts"],"sourcesContent":["import { Options } from 'pobpack-types';\n\nexport default (options: Partial<Options>): Options => ({\n  aliases: options.aliases || {},\n  babel: options.babel || {},\n  defines: options.defines || {},\n  entries: options.entries || ['index'],\n  env: options.env || process.env.NODE_ENV,\n  hmr: options.hmr,\n  includeModules: options.includeModules || [],\n  includePaths: options.includePaths || [],\n  jsLoaders: options.jsLoaders,\n  moduleRules: options.moduleRules,\n  paths: { src: 'src', build: 'build', ...options.paths },\n  optimization: options.optimization,\n  plugins: options.plugins || [],\n  prependPlugins: options.prependPlugins || [],\n  resolveLoaderModules: options.resolveLoaderModules,\n  typescript: options.typescript || false,\n  webpackPrefixPackageFields: options.webpackPrefixPackageFields || [],\n});\n","import path from 'path';\nimport { existsSync } from 'fs';\nimport { Options, FilledWebpackConfiguration } from 'pobpack-types';\nimport createOptions from './createOptions';\n\nexport type CreateWebpackConfig = (\n  options: Options,\n) => FilledWebpackConfiguration;\n\nexport default (\n  createWebpackConfig: CreateWebpackConfig,\n): ((options: Partial<Options>) => FilledWebpackConfiguration) => {\n  const wrapCreateWebpackConfig = (\n    options: Partial<Options>,\n  ): FilledWebpackConfiguration => createWebpackConfig(createOptions(options));\n\n  return (options: Partial<Options>): FilledWebpackConfiguration => {\n    const appWebpackConfigPath = path.resolve('createAppWebpackConfig.js');\n    if (existsSync(appWebpackConfigPath)) {\n      console.info('Using app createAppWebpackConfig.js');\n      // eslint-disable-next-line import/no-dynamic-require, global-require, @typescript-eslint/no-var-requires\n      const appWebpackConfigCreator = require(appWebpackConfigPath);\n      if (typeof appWebpackConfigCreator !== 'function') {\n        console.error(\n          'app createAppWebpackConfig.js should export a function\\n' +\n            'module.exports = function (config, options) { ... }',\n        );\n      }\n\n      options = createOptions(options);\n      const config = appWebpackConfigCreator(wrapCreateWebpackConfig, options);\n\n      if (typeof config !== 'object') {\n        console.error(\n          'app createAppWebpackConfig.js should return the config\\n' +\n            'function (config, options) { return config(options); }',\n        );\n      }\n\n      return config;\n    } else {\n      return wrapCreateWebpackConfig(options);\n    }\n  };\n};\n","/* eslint-disable no-console */\n\nimport { addConfig, levels } from 'nightingale';\nimport Logger from 'nightingale-logger';\nimport ConsoleHandler from 'nightingale-console';\nimport formatWebpackMessages, {\n  FormattedResult,\n} from 'react-dev-utils/formatWebpackMessages';\nimport { Compiler } from 'webpack';\n\nexport interface Options {\n  bundleName: string;\n  successMessage?: string;\n}\n\naddConfig({ key: 'pobpack-utils', handler: new ConsoleHandler(levels.INFO) });\nconst logger = new Logger('pobpack-utils', 'pobpack');\nconst isSuccessful = (messages: FormattedResult) =>\n  !messages.errors.length && !messages.warnings.length;\n\nconst pluginName = 'pobpack/FriendlyErrorsWebpackPlugin';\n\nexport default class FriendlyErrorsWebpackPlugin {\n  logger: Logger;\n\n  bundleName: string;\n\n  successMessage?: string;\n\n  constructor(options: Options) {\n    this.bundleName = options.bundleName;\n    this.successMessage = options.successMessage;\n    this.logger = logger.context({ bundleName: options.bundleName });\n  }\n\n  apply(compiler: Compiler) {\n    // webpack is recompiling\n    compiler.hooks.invalid.tap(pluginName, () => {\n      this.logger.info('Compiling...');\n    });\n\n    // compilation done\n    compiler.hooks.done.tap(pluginName, (stats) => {\n      const messages = formatWebpackMessages(stats.toJson({}));\n      // const messages = stats.toJson({}, true);\n\n      if (isSuccessful(messages)) {\n        this.logger.success('Compiled successfully!');\n        if (this.successMessage) {\n          console.log(this.successMessage);\n        }\n        return;\n      }\n\n      if (messages.errors.length !== 0) {\n        this.logger.critical('Failed to compile.');\n        console.log();\n        messages.errors.forEach((message: string) => {\n          console.log(message);\n          console.log();\n        });\n        return;\n      }\n\n      if (messages.warnings.length !== 0) {\n        this.logger.critical('Compiled with warnings.');\n        console.log();\n        messages.warnings.forEach((message: string) => {\n          console.log(message);\n          console.log();\n        });\n      }\n    });\n  }\n}\n","import { execSync } from 'child_process';\nimport { promisify } from 'util';\nimport colorette from 'colorette';\nimport ProgressBar from 'progress';\nimport webpack, { ProgressPlugin, Stats } from 'webpack';\nimport {\n  PobpackCompiler,\n  CreateCompilerOptions,\n  FilledWebpackConfiguration,\n} from 'pobpack-types';\nimport FriendlyErrorsWebpackPlugin from './FriendlyErrorsWebpackPlugin';\n\nconst buildThrowOnError = (stats: Stats): Stats => {\n  if (!stats.hasErrors()) {\n    return stats;\n  }\n\n  throw new Error(stats.toString({}));\n};\n\nexport default (\n  bundleName: string,\n  webpackConfig: FilledWebpackConfiguration,\n  { progressBar = true, successMessage }: CreateCompilerOptions = {},\n): PobpackCompiler => {\n  const compiler = webpack(webpackConfig);\n\n  if (progressBar && process.stdout.isTTY) {\n    let bar: ProgressBar;\n    const progressPlugin = new ProgressPlugin(\n      (percentage: number, msg: string) => {\n        if (percentage === 0) {\n          bar = new ProgressBar(\n            `${colorette.bold(\n              colorette.yellow(`Building ${bundleName} bundle...`),\n            )} ${colorette.bold(':percent')} [:bar] → :msg`,\n            {\n              incomplete: ' ',\n              complete: '▇',\n              total: 50,\n              clear: true,\n              stream: process.stdout,\n            },\n          );\n          // } else if (percentage === 1) {\n          //   // bar.clear();\n          //   bar = null;\n        } else {\n          bar.update(percentage, {\n            msg: msg.length > 20 ? `${msg.substr(0, 20)}...` : msg,\n          });\n        }\n      },\n    );\n    progressPlugin.apply(compiler);\n  }\n\n  // human-readable error messages\n  new FriendlyErrorsWebpackPlugin({ bundleName, successMessage }).apply(\n    compiler,\n  );\n\n  const promisifyRun: () => Promise<Stats> = promisify(\n    compiler.run.bind(compiler),\n  );\n\n  return {\n    compiler,\n    webpackConfig,\n    clean: (): void | Buffer => {\n      if (webpackConfig.output && webpackConfig.output.path) {\n        return execSync(`rm -Rf ${webpackConfig.output.path}`);\n      }\n    },\n    run: (): Promise<Stats> => promisifyRun().then(buildThrowOnError),\n    watch: (callback: (stats: Stats) => any) =>\n      compiler.watch({}, (err: Error, stats: Stats) => {\n        if (err) return;\n        if (stats.hasErrors()) return;\n        buildThrowOnError(stats);\n        callback(stats);\n      }),\n  };\n};\n","import { realpathSync } from 'fs';\nimport { resolve, dirname } from 'path';\nimport resolveFrom from 'resolve-from';\nimport findUp from 'find-up';\nimport { Options } from 'pobpack-types';\n// with node 10.12\n// import { createRequireFromPath } from 'module';\n// const requireFromPwd = createRequireFromPath(process.cwd());\n\nexport default (options: Options) => ({\n  strictExportPresence: true,\n\n  rules: [\n    // Disable require.ensure as it's not a standard language feature.\n    { parser: { requireEnsure: false } },\n\n    // tsx? / jsx?\n    {\n      test: options.typescript ? /\\.[tj]sx?$/ : /\\.jsx?$/,\n      include: [\n        resolve(options.paths.src as string),\n        ...options.includeModules\n          .map((includeModule) => {\n            const packageJson = findUp.sync('package.json', {\n              cwd: dirname(\n                // requireFromPwd.resolve(includeModule)\n                realpathSync(resolveFrom(process.cwd(), includeModule)),\n              ),\n            });\n\n            if (!packageJson) return;\n            return packageJson.slice(0, -'package.json'.length);\n          })\n          .filter(Boolean),\n        ...options.includePaths,\n      ],\n      loaders: [\n        {\n          loader: require.resolve('babel-loader'),\n          options: {\n            babelrc: false,\n            cacheDirectory: true,\n            ...options.babel,\n          },\n        },\n        ...(options.jsLoaders || []),\n      ],\n    },\n\n    // other rules\n    ...(options.moduleRules || []),\n  ],\n});\n","import webpack from 'webpack';\nimport CaseSensitivePathsPlugin from 'case-sensitive-paths-webpack-plugin';\nimport { Options } from 'pobpack-types';\n\nexport default (options: Options) =>\n  [\n    ...options.prependPlugins,\n\n    // ignore files when watching\n    new webpack.WatchIgnorePlugin([\n      // typescript definitions\n      /\\.d\\.ts$/,\n    ]),\n\n    // enforces the entire path of all required modules match the exact case\n    // of the actual path on disk. Using this plugin helps alleviate cases\n    // for developers working on case insensitive systems like OSX.\n    options.env !== 'production' && new CaseSensitivePathsPlugin(),\n\n    new webpack.DefinePlugin({\n      'process.env.NODE_ENV': JSON.stringify(options.env),\n      ...options.defines,\n    }),\n\n    options.hmr && new webpack.HotModuleReplacementPlugin(),\n\n    /* replace object-assign ponyfill to use native implementation */\n\n    // Array.isArray\n    new webpack.NormalModuleReplacementPlugin(\n      /.*\\/node_modules\\/isarray\\/index.js$/,\n      require.resolve('../replacements/Array.isArray.js'),\n    ),\n\n    // Object.assign\n    new webpack.NormalModuleReplacementPlugin(\n      /.*\\/node_modules\\/(object-assign|extend-shallow)\\/index.js$/,\n      require.resolve('../replacements/Object.assign.js'),\n    ),\n\n    // Object.setPrototypeOf\n    new webpack.NormalModuleReplacementPlugin(\n      /.*\\/node_modules\\/setprototypeof\\/index.js$/,\n      require.resolve('../replacements/Object.setPrototypeOf.js'),\n    ),\n\n    // Promise\n    new webpack.NormalModuleReplacementPlugin(\n      /.*\\/node_modules\\/any-promise\\/index.js$/,\n      require.resolve('../replacements/Promise.js'),\n    ),\n\n    // String.prototype.repeat\n    new webpack.NormalModuleReplacementPlugin(\n      /.*\\/node_modules\\/repeat-string\\/index.js$/,\n      require.resolve('../replacements/String.prototype.repeat.js'),\n    ),\n\n    // Symbol.observable\n    // https://github.com/tc39/proposal-observable\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/observable\n    // new webpack.NormalModuleReplacementPlugin(\n    //   /.*\\/node_modules\\/symbol-observable\\/es\\/ponyfill.js$/,\n    //   require.resolve('../replacements/Symbol.observable.js'),\n    // ),\n\n    ...options.plugins,\n  ].filter(Boolean);\n","/* eslint-disable prettier/prettier */\nimport { resolve } from 'path';\nimport webpack from 'webpack';\nimport { Options } from 'pobpack-types';\n\nconst ExcludesFalse = Boolean as any as <T>(x: T | false) => x is T;\n\nexport default (modulePrefixPackageFields: string[], options: Options): webpack.Resolve  => ({\n  // https://github.com/DefinitelyTyped/DefinitelyTyped/pull/25209\n  // cacheWithContext: false,\n\n  modules: [\n    'node_modules',\n    resolve('src')\n  ],\n  extensions: ([\n    options.typescript && '.ts',\n    options.typescript && '.tsx',\n    '.js',\n    '.jsx',\n  ]  as (string | false)[]).filter(ExcludesFalse),\n\n  mainFields: [\n    ...([] as (string | false)[]).concat(...modulePrefixPackageFields.map((prefix: string): (string | false)[] => ([\n      options.env !== 'production' && `module:${prefix}-dev`,\n      `module:${prefix}`,\n      // old `webpack:` syntax\n      options.env !== 'production' && `webpack:${prefix}-dev`,\n      `webpack:${prefix}`,\n    ]))),\n\n    options.env !== 'production' && 'module-dev',\n    'module',\n    // old webpack: syntax\n    options.env !== 'production' && 'webpack:main-dev',\n    'webpack:main',\n\n    ...(!modulePrefixPackageFields.includes('browser') ? [\n    ] : [\n      // Browser builds\n      options.env !== 'production' && 'browser-dev',\n      'browser',\n    ]),\n    options.env !== 'production' && 'main-dev',\n    'main',\n  ].filter(ExcludesFalse) as string[],\n\n  aliasFields: [\n    ...([] as (string | false)[]).concat(...modulePrefixPackageFields.map((prefix: string): (string | false)[] => ([\n      options.env !== 'production' && `module:aliases-${prefix}-dev`,\n      `module:aliases-${prefix}`,\n\n      // old webpack: syntax\n      options.env !== 'production' && `webpack:aliases-${prefix}-dev`,\n      `webpack:aliases-${prefix}`,\n    ]))),\n\n    options.env !== 'production' && 'module:aliases-dev',\n    'module:aliases',\n\n    // old webpack: syntax\n    options.env !== 'production' && 'webpack:aliases-dev',\n    'webpack:aliases',\n    'webpack',\n    modulePrefixPackageFields.includes('browser') && options.env !== 'production' && 'browser-dev',\n    modulePrefixPackageFields.includes('browser') && 'browser',\n  ].filter(ExcludesFalse) as string[],\n\n  alias: options.aliases,\n});\n"],"names":["options","aliases","babel","defines","entries","env","process","NODE_ENV","hmr","includeModules","includePaths","jsLoaders","moduleRules","paths","src","build","optimization","plugins","prependPlugins","resolveLoaderModules","typescript","webpackPrefixPackageFields","createWebpackConfig","wrapCreateWebpackConfig","createOptions","appWebpackConfigPath","path","resolve","existsSync","console","info","appWebpackConfigCreator","require","error","config","addConfig","key","handler","ConsoleHandler","levels","INFO","logger","Logger","isSuccessful","messages","errors","length","warnings","pluginName","FriendlyErrorsWebpackPlugin","constructor","bundleName","successMessage","context","apply","compiler","hooks","invalid","tap","done","stats","formatWebpackMessages","toJson","success","log","critical","forEach","message","buildThrowOnError","hasErrors","Error","toString","webpackConfig","progressBar","webpack","stdout","isTTY","bar","progressPlugin","ProgressPlugin","percentage","msg","ProgressBar","colorette","bold","yellow","incomplete","complete","total","clear","stream","update","substr","promisifyRun","promisify","run","bind","clean","output","execSync","then","watch","callback","err","strictExportPresence","rules","parser","requireEnsure","test","include","map","includeModule","packageJson","findUp","sync","cwd","dirname","realpathSync","resolveFrom","slice","filter","Boolean","loaders","loader","babelrc","cacheDirectory","WatchIgnorePlugin","CaseSensitivePathsPlugin","DefinePlugin","JSON","stringify","HotModuleReplacementPlugin","NormalModuleReplacementPlugin","ExcludesFalse","modulePrefixPackageFields","modules","extensions","mainFields","concat","prefix","includes","aliasFields","alias"],"mappings":"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"}